// ========== Ø¥ØµÙ„Ø§Ø­ Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Push Ù…Ù† Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… ==========

// Ø¯Ø§Ù„Ø© Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø´ØªØ±ÙƒÙŠÙ† - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…ØµØ­Ø­Ø©
async function sendPushpadNotification(title, message) {
    try {
        // âš ï¸ âš ï¸ âš ï¸ Ù‡Ø§Ù…: Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ø§Ù„ØªÙˆÙƒÙ† Ø§Ù„ØµØ­ÙŠØ­ Ù…Ù†:
        // 1. Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¥Ù„Ù‰ pushpad.xyz
        // 2. Ø§Ù†ØªÙ‚Ù„ Ø¥Ù„Ù‰ Account â†’ Access Tokens
        // 3. Ø£Ù†Ø´Ø¦ ØªÙˆÙƒÙ† Ø¬Ø¯ÙŠØ¯ Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„ØªÙˆÙƒÙ† Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯
        const API_TOKEN = 'YOUR_ACTUAL_API_TOKEN_HERE'; // Ø§Ø³ØªØ¨Ø¯Ù„ Ù‡Ø°Ø§ Ø¨Ø§Ù„ØªÙˆÙƒÙ† Ø§Ù„ÙØ¹Ù„ÙŠ
        
        console.log('ğŸš€ Ù…Ø­Ø§ÙˆÙ„Ø© Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± Push...');
        console.log('ğŸ“ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:', title);
        console.log('ğŸ“ Ø§Ù„Ø±Ø³Ø§Ù„Ø©:', message.substring(0, 120));
        
        // Ø§Ù„Ù‡ÙŠÙƒÙ„ Ø§Ù„ØµØ­ÙŠØ­ Ø­Ø³Ø¨ ÙˆØ«Ø§Ø¦Ù‚ Pushpad
        const notificationData = {
            body: message.substring(0, 120), // 120 Ø­Ø±Ù ÙƒØ­Ø¯ Ø£Ù‚ØµÙ‰
            title: title,
            target_url: 'https://ameen-algmady.github.io/alnhdah/index.html',
            icon_url: 'https://ameen-algmady.github.io/alnhdah/logo.png',
            ttl: 86400, // ØµØ§Ù„Ø­ Ù„Ù…Ø¯Ø© 24 Ø³Ø§Ø¹Ø©
            require_interaction: false,
            silent: false
        };
        
        console.log('ğŸ“¤ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø±Ø³Ù„Ø©:', notificationData);
        
        // Project ID Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ Ù‡Ùˆ 9091 ÙƒÙ…Ø§ ÙÙŠ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø³Ø§Ø¨Ù‚
        const response = await fetch('https://api.pushpad.xyz/v1/projects/9091/notifications', {
            method: 'POST',
            headers: {
                'Authorization': `Token token="${API_TOKEN}"`,
                'Content-Type': 'application/json',
                'Accept': 'application/json'
            },
            body: JSON.stringify(notificationData)
        });
        
        console.log('ğŸ“¡ Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©:', response.status);
        console.log('ğŸ“¡ Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ù†Øµ:', response.statusText);
        
        const responseText = await response.text();
        console.log('ğŸ“¨ Ù†Øµ Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©:', responseText);
        
        let result;
        try {
            result = JSON.parse(responseText);
        } catch (e) {
            result = { error: 'ØªÙ†Ø³ÙŠÙ‚ JSON ØºÙŠØ± ØµØ§Ù„Ø­', raw: responseText };
        }
        
        if (response.ok) {
            console.log('âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ø¨Ù†Ø¬Ø§Ø­:', result);
            return { 
                success: true, 
                message: 'ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø´ØªØ±ÙƒÙŠÙ†',
                data: result 
            };
        } else {
            console.error('âŒ Ø®Ø·Ø£ Ù…Ù† Pushpad API:', result);
            
            let errorMessage = 'ÙØ´Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„';
            if (result.error) {
                errorMessage += ': ' + result.error;
            } else if (response.status === 401) {
                errorMessage = 'ØºÙŠØ± Ù…ØµØ±Ø­ - ØªØ£ÙƒØ¯ Ù…Ù† ØµØ­Ø© API Token';
            } else if (response.status === 404) {
                errorMessage = 'Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ - ØªØ£ÙƒØ¯ Ù…Ù† Project ID';
            }
            
            return { 
                success: false, 
                message: errorMessage,
                details: result 
            };
        }
    } catch (error) {
        console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„:', error);
        return { 
            success: false, 
            message: 'Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„: ' + error.message 
        };
    }
}

// ========== Ø·Ø±ÙŠÙ‚Ø© Ø¨Ø¯ÙŠÙ„Ø© Ø£Ø¨Ø³Ø· ==========
async function sendSimpleNotification(title, message) {
    // Ø·Ø±ÙŠÙ‚Ø© Ø¨Ø¯ÙŠÙ„Ø© Ø¥Ø°Ø§ ÙƒØ§Ù† Pushpad Ù„Ø§ ÙŠØ¹Ù…Ù„
    console.log('ğŸ“± Ø·Ø±ÙŠÙ‚Ø© Ø¨Ø¯ÙŠÙ„Ø© Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª');
    
    try {
        // ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø®Ø¯Ù…Ø© Ø¨Ø¯ÙŠÙ„Ø© Ù‡Ù†Ø§ Ù…Ø«Ù„:
        // - OneSignal
        // - Firebase Cloud Messaging
        // - Ø£Ùˆ Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­
        
        // ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø­Ø§Ù„ÙŠØŒ Ø³Ù†Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† ÙÙ‚Ø·
        const saved = await saveNotificationToGitHub(title, message);
        
        if (saved) {
            // Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯ÙŠÙ† Ø¹Ù„Ù‰ Ø§Ù„ØµÙØ­Ø©
            broadcastNotification(title, message);
            
            return {
                success: true,
                message: 'ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† ÙˆØ³ÙŠØ¸Ù‡Ø± Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø¹Ù†Ø¯ ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙØ­Ø©'
            };
        } else {
            return {
                success: false,
                message: 'ÙØ´Ù„ Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†'
            };
        }
    } catch (error) {
        console.error('âŒ Ø®Ø·Ø£:', error);
        return {
            success: false,
            message: 'Ø®Ø·Ø£: ' + error.message
        };
    }
}

// ========== ÙˆØ¸ÙŠÙØ© Ø¨Ø« Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù†Ø´Ø·ÙŠÙ† ==========
function broadcastNotification(title, message) {
    // ØªØ®Ø²ÙŠÙ† Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯ ÙÙŠ localStorage Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
    const newNotification = {
        id: Date.now(),
        title: title,
        message: message,
        timestamp: new Date().toISOString(),
        type: 'broadcast'
    };
    
    // Ø­ÙØ¸ ÙÙŠ localStorage Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
    localStorage.setItem('jeel_latest_notification', JSON.stringify(newNotification));
    localStorage.setItem('jeel_notification_update', Date.now().toString());
    
    console.log('ğŸ“¢ ØªÙ… Ø¨Ø« Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù†Ø´Ø·ÙŠÙ†');
    
    // Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© Ø¹Ø¨Ø± postMessage Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ù…ÙØªÙˆØ­Ø©
    if (window.opener) {
        window.opener.postMessage({
            type: 'NEW_NOTIFICATION',
            notification: newNotification
        }, '*');
    }
    
    // ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¶Ø§ÙØ© WebSocket Ù‡Ù†Ø§ Ù„Ø¨Ø« Ø­Ù‚ÙŠÙ‚ÙŠ
}

// ========== Ø±Ø¨Ø· Ø¨Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…Ø­Ø³Ù†Ø© ==========
document.addEventListener('DOMContentLoaded', function() {
    const notificationForm = document.getElementById('notificationForm');
    
    if (notificationForm) {
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ
        setupLivePreview();
        
        notificationForm.addEventListener('submit', async function(e) {
            e.preventDefault();
            
            console.log('ğŸ“ Ø¨Ø¯Ø¡ Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø¹Ù„Ø§Ù† Ø¬Ø¯ÙŠØ¯...');
            
            const title = document.getElementById('title').value;
            const message = document.getElementById('message').value;
            const type = document.getElementById('type').value;
            const isUrgent = document.getElementById('urgent').checked;
            
            if (!title || !message) {
                alert('âš ï¸ ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† ÙˆØ§Ù„Ù†Øµ');
                return;
            }
            
            // 1. Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù… Ø£ÙˆÙ„Ø§Ù‹
            const notificationId = await saveNotificationToSystem(title, message, type, isUrgent);
            
            if (!notificationId) {
                alert('âŒ ÙØ´Ù„ Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…');
                return;
            }
            
            console.log('âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…ØŒ ID:', notificationId);
            
            // 2. Ø³Ø¤Ø§Ù„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¹Ù† Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± Push
            const sendPush = confirm(`ğŸ“¢ Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± Push Ù„Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†ØŸ
            
Ø§Ù„Ø¹Ù†ÙˆØ§Ù†: ${title}

${isUrgent ? 'âš ï¸ Ù‡Ø°Ø§ Ø¥Ø¹Ù„Ø§Ù† Ø¹Ø§Ø¬Ù„\n\n' : ''}Ø³ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„Ù‡ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø´ØªØ±ÙƒÙŠÙ†.`);
            
            if (sendPush) {
                showLoading('Ø¬Ø§Ø±ÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±...');
                
                try {
                    // Ù…Ø­Ø§ÙˆÙ„Ø© Ø¥Ø±Ø³Ø§Ù„ Ø¹Ø¨Ø± Pushpad
                    console.log('ğŸš€ Ù…Ø­Ø§ÙˆÙ„Ø© Ø¥Ø±Ø³Ø§Ù„ Ø¹Ø¨Ø± Pushpad...');
                    const result = await sendPushpadNotification(title, message);
                    
                    hideLoading();
                    
                    if (result.success) {
                        alert(`ğŸ‰ ${result.message}\n\nØ³ÙŠØµÙ„ÙƒÙ… Ø¥Ø´Ø¹Ø§Ø± Ø¹Ù„Ù‰ Ø§Ù„Ù‡ÙˆØ§ØªÙ Ø®Ù„Ø§Ù„ Ø«ÙˆØ§Ù†Ù.`);
                        
                        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
                        updateNotificationStats('push_sent');
                    } else {
                        console.warn('âš ï¸ ÙØ´Ù„ Ø¥Ø±Ø³Ø§Ù„ PushpadØŒ Ø¬Ø±Ø¨ Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¨Ø¯ÙŠÙ„Ø©:', result.message);
                        
                        // Ø³Ø¤Ø§Ù„ Ø¹Ù† Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¨Ø¯ÙŠÙ„Ø©
                        const useAlternative = confirm(`âš ï¸ ${result.message}\n\nÙ‡Ù„ ØªØ±ÙŠØ¯ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¨Ø¯ÙŠÙ„Ø©ØŸ`);
                        
                        if (useAlternative) {
                            showLoading('Ø¬Ø§Ø±ÙŠ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¨Ø¯ÙŠÙ„Ø©...');
                            const altResult = await sendSimpleNotification(title, message);
                            hideLoading();
                            
                            alert(altResult.success ? 
                                `âœ… ${altResult.message}` : 
                                `âŒ ${altResult.message}`);
                        } else {
                            alert('âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ù…Ø­Ù„ÙŠØ§Ù‹ ÙÙ‚Ø·.\nØ³ÙŠØ¸Ù‡Ø± Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø¹Ù†Ø¯ Ø²ÙŠØ§Ø±Ø© Ø§Ù„Ù…ÙˆÙ‚Ø¹.');
                        }
                    }
                } catch (error) {
                    hideLoading();
                    console.error('âŒ Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹:', error);
                    alert('âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹. ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ù…Ø­Ù„ÙŠØ§Ù‹.');
                }
            } else {
                alert('âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†.\nØ³ÙŠØ¸Ù‡Ø± Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø¹Ù†Ø¯ Ø²ÙŠØ§Ø±Ø© Ø§Ù„Ù…ÙˆÙ‚Ø¹.');
            }
            
            // 3. ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
            this.reset();
            updatePreview();
            loadNotificationsList();
            updateStats();
            
            console.log('âœ… Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø§ÙƒØªÙ…Ù„Øª');
        });
    }
    
    // Ø²Ø± Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± ÙŠØ¯ÙˆÙŠ
    setupManualPushButton();
});

// ========== ÙˆØ¸Ø§Ø¦Ù Ù…Ø³Ø§Ø¹Ø¯Ø© ==========
function setupLivePreview() {
    const inputs = ['title', 'message', 'type', 'target'];
    inputs.forEach(id => {
        const element = document.getElementById(id);
        if (element) {
            element.addEventListener('input', updatePreview);
            element.addEventListener('change', updatePreview);
        }
    });
}

function setupManualPushButton() {
    const manualBtn = document.createElement('button');
    manualBtn.type = 'button';
    manualBtn.className = 'btn btn-warning mt-3';
    manualBtn.innerHTML = '<i class="fas fa-paper-plane me-2"></i>Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± Push ÙŠØ¯ÙˆÙŠØ§Ù‹';
    manualBtn.onclick = async function() {
        const title = prompt('Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±:', 'Ø¥Ø¹Ù„Ø§Ù† Ù‡Ø§Ù… Ù…Ù† Ù…Ø¯Ø§Ø±Ø³ Ø¬ÙŠÙ„ Ø§Ù„Ù†Ù‡Ø¶Ø©');
        if (!title) return;
        
        const message = prompt('Ù†Øµ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±:', 'ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ø·Ù„Ø§Ø¹ Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ø§Ù„Ø¬Ø¯ÙŠØ¯ ÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚');
        if (!message) return;
        
        const confirmSend = confirm(`Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø±Ø³Ø§Ù„ Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø´ØªØ±ÙƒÙŠÙ†ØŸ
        
ğŸ“Œ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†: ${title}

ğŸ“ Ø§Ù„Ø±Ø³Ø§Ù„Ø©: ${message.substring(0, 100)}${message.length > 100 ? '...' : ''}`);
        
        if (confirmSend) {
            showLoading('Ø¬Ø§Ø±ÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±...');
            const result = await sendPushpadNotification(title, message);
            hideLoading();
            
            if (result.success) {
                alert(`âœ… ${result.message}\n\nØ³ÙŠØµÙ„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ø®Ù„Ø§Ù„ Ø«ÙˆØ§Ù†Ù.`);
            } else {
                alert(`âŒ ${result.message}\n\nØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø®Ø·Ø£: ${JSON.stringify(result.details || {})}`);
            }
        }
    };
    
    // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø²Ø± Ø¥Ù„Ù‰ Ø§Ù„ØµÙØ­Ø©
    const container = document.querySelector('#add .row .col-md-6:first-child');
    if (container) {
        const div = document.createElement('div');
        div.className = 'mt-4';
        div.innerHTML = `
            <div class="alert alert-info">
                <h6><i class="fas fa-paper-plane me-2"></i>Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª ÙÙˆØ±ÙŠØ©</h6>
                <p class="mb-2">Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± Push Ù…Ø¨Ø§Ø´Ø±Ø© Ø¥Ù„Ù‰ Ù‡ÙˆØ§ØªÙ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø´ØªØ±ÙƒÙŠÙ†</p>
            </div>
        `;
        container.appendChild(div);
        div.querySelector('.alert').appendChild(manualBtn);
    }
}

async function saveNotificationToSystem(title, message, type, urgent) {
    try {
        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©
        await loadDataFromGitHub();
        
        // Ø¥Ù†Ø´Ø§Ø¡ Ø¥Ø¹Ù„Ø§Ù† Ø¬Ø¯ÙŠØ¯
        const newNotification = {
            id: Date.now(),
            title: title,
            message: message,
            type: type,
            target: 'all',
            expiry: null,
            urgent: urgent,
            status: 'active',
            created: new Date().toISOString(),
            views: 0,
            push_sent: false
        };
        
        // Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
        notifications.unshift(newNotification);
        
        // Ø­ÙØ¸
        await saveData();
        
        return newNotification.id;
    } catch (error) {
        console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†:', error);
        return null;
    }
}

function updateNotificationStats(action) {
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡
    if (action === 'push_sent') {
        stats.pushNotificationsSent = (stats.pushNotificationsSent || 0) + 1;
        stats.lastPushSent = new Date().toISOString();
        localStorage.setItem('jeel_stats', JSON.stringify(stats));
    }
}

// ========== Ø±Ø³Ø§Ù„Ø© ØªØ±Ø­ÙŠØ¨ÙŠØ© ÙˆØªØ´Ø®ÙŠØµÙŠØ© ==========
console.log('ğŸ”§ Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø¬Ø§Ù‡Ø²Ø©');
console.log('âš ï¸ Ù„Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ØµØ­ÙŠØ­:');
console.log('1. ØªØ£ÙƒØ¯ Ù…Ù† ØµØ­Ø© API Token ÙÙŠ Ø³Ø·Ø± 13');
console.log('2. ØªØ£ÙƒØ¯ Ù…Ù† Project ID (9091)');
console.log('3. ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø­Ø³Ø§Ø¨ Pushpad Ù†Ø´Ø·');